var Cjs=function(){};Cjs._version=function(){return"0.1"},Cjs._log=function(){},Cjs._extend=function(e){var t=this,i=function(){return t.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=t.prototype,i.prototype=new n,_.extend(i.prototype,e),i},Cjs._shift=[].shift,Cjs._call=function(e,t){var i=function(){return e.apply(this,t)};i()},Cjs._Event=function(){},Cjs._Event.trigger=function(e){var t=e;Cjs._shift.apply(arguments),this.triggerEx(t,arguments)},Cjs._Event.triggerEx=function(e,t){if(!_.isString(e))return Cjs._log("Cjs.Event","Invalid parameter - name, string expected."),void 0;if(!_.isArray(t)&&!_.isArguments(t))return Cjs._log("Cjs.Event","Invalid parameter - args, array expected."),void 0;if(this._events&&this._events[e]){Cjs._log("Cjs.Event",'Triggered an event "'+e+'".');for(var i=this._events[e],n=0;n<i.length;++n)Cjs._call(i[n].func,t)}},Cjs._Event.subscribe=function(e,t,i){if(!_.isString(e))return Cjs._log("Cjs.Event","Invalid parameter - name, string expected."),void 0;if(_.isString(t)){if(_.isUndefined(i))return Cjs._log("Cjs.Event","Invalid parameter - obj, object expected."),void 0;t=i[t],_.isFunction(t)&&(t=_.bind(t,i))}return _.isFunction(t)?(Cjs._log("Cjs.Event",'Subscribed to "'+e+'".'),this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push({func:t}),void 0):(Cjs._log("Cjs.Event","Invalid parameter - func, function expected."),void 0)},Cjs._Event.unsubscribe=function(e,t,i){if(!_.isString(e))return Cjs._log("Cjs.Event","Invalid parameter - name, string expected."),void 0;if(_.isString(t)){if(_.isUndefined(i))return Cjs._log("Cjs.Event","Invalid parameter - obj, object expected."),void 0;t=i[t],_.isFunction(t)&&(t=_.bind(t,i))}if(!_.isFunction(t))return Cjs._log("Cjs.Event","Invalid parameter - func, function expected."),void 0;if(this._events&&this._events[e]){Cjs._log("Cjs.Event",'Unsubscribed to "'+e+'".');for(var n=this._events[e],s=0;s<n.length;++s)n[s].func==t&&n.splice(s--,1)}},Cjs._Model=function(){},Cjs._Model.defaults={},Cjs._Model.init=function(){},Cjs._Model.fetch=function(e){if(!_.isString(e))return Cjs._log("Cjs.Model","Invalid parameter - url, string expected."),void 0;Cjs._log("Cjs.Model",'Fetching model @ "'+e+'".');var t=this,i=$.ajax({url:e,type:"GET",dataType:"json",async:!0});i.done(function(e){t.reset(),t.set(e),t.trigger("fetchSuccess",t)}),i.fail(function(e,i,n){t.trigger("fetchFailure",t,i,n)})},Cjs._Model.create=function(e,t){if(!_.isString(e))return Cjs._log("Cjs.Model","Invalid parameter - url, string expected."),void 0;Cjs._log("Cjs.Model",'Creating model @ "'+e+'".'),_.isUndefined(t)&&(t=this.json());var i=this,n=$.ajax({url:e,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t),processData:!1,async:!0});n.done(function(){i.trigger("createSuccess",i)}),n.fail(function(e,t,n){i.trigger("createFailure",i,t,n)})},Cjs._Model.update=function(e,t){if(!_.isString(e))return Cjs._log("Cjs.Model","Invalid parameter - url, string expected."),void 0;Cjs._log("Cjs.Model",'Updating model @ "'+e+'".'),_.isUndefined(t)&&(t=this.json());var i=this,n=$.ajax({url:e,type:"PUT",dataType:"json",contentType:"application/json",data:JSON.stringify(t),processData:!1,async:!0});n.done(function(){i.trigger("updateSuccess",i)}),n.fail(function(e,t,n){i.trigger("updateFailure",i,t,n)})},Cjs._Model.destroy=function(e,t){if(!_.isString(e))return Cjs._log("Cjs.Model","Invalid parameter - url, string expected."),void 0;Cjs._log("Cjs.Model",'Destroying model @ "'+e+'".');var i=this,n=$.ajax({url:e,type:"DELETE",dataType:"json",contentType:"application/json",data:JSON.stringify(t),processData:!1,async:!0});n.done(function(){i.trigger("destroySuccess",i)}),n.fail(function(e,t,n){i.trigger("destroyFailure",i,t,n)})},Cjs._Model.get=function(e){return _.isString(e)?this.attributes[e]:(Cjs._log("Cjs.Model","Invalid parameter - key, string expected."),void 0)},Cjs._Model.set=function(e){var t=this;_.each(e,function(e,i){t.attributes[i]=e}),this.trigger("changed",this,e)},Cjs._Model.reset=function(){this.attributes={},this.trigger("reset",this),this.set(this.defaults)},Cjs._Model.json=function(){return this.attributes},Cjs._Model.stringify=function(){return JSON.stringify(this.json())},Cjs.Model=function(e,t){if(!_.isUndefined(t)){var i=this;_.each(t,function(e,t){i[t]=e})}this.reset(),_.isUndefined(e)||this.set(e),Cjs._shift.apply(arguments),Cjs._shift.apply(arguments),this.init.apply(this,arguments)},_.extend(Cjs.Model.prototype,Cjs._Model,Cjs._Event),Cjs.Model.extend=Cjs._extend,Cjs._Collection=function(){},Cjs._Collection.model=Cjs.Model,Cjs._Collection.init=function(){},Cjs._Collection.fetch=function(e){if(!_.isString(e))return Cjs._log("Cjs.Collection","Invalid parameter - url, string expected."),void 0;Cjs._log("Cjs.Collection",'Fetching from "'+e+'".');var t=this,i=$.ajax({url:e,type:"GET",dataType:"json",async:!0});i.done(function(e){t.models=[];for(var i=0;i<e.length;++i){var n=new t.model;n.set(e[i]),t.add(n)}t.trigger("fetchSuccess",t)}),i.fail(function(e,i,n){t.trigger("fetchFailure",t,i,n)})},Cjs._Collection.at=function(e){return this.models[e]},Cjs._Collection.add=function(e){this.models.push(e),this.length=this.models.length,this.trigger("added",this,e)},Cjs._Collection.addAll=function(e){if(!_.isArray(e))return Cjs._log("Cjs.Collection","Invalid parameter - models, array expected."),void 0;var t=this;_.each(e,function(e){t.add(e)})},Cjs._Collection.remove=function(e){if(!_.isObject(e))return Cjs._log("Cjs.Collection","Invalid parameter - attributes, object expected."),void 0;for(var t=0;t<this.models.length;++t){var i=this.models[t],n=!0;for(var s in e)if(e[s]!=i.attributes[s]){n=!1;break}n&&(this.models.splice(t--,1),this.trigger("removed",this,i))}this.length=this.models.length},Cjs._Collection.each=function(e){return _.isFunction(e)?(_.each(this.models,e),void 0):(Cjs._log("Cjs.Collection","Invalid parameter - func, function expected."),void 0)},Cjs._Collection.reset=function(){this.models=[],this.length=0,this.trigger("reset",this)},Cjs._Collection.json=function(){var e=[];return _.each(this.models,function(t){e.push(t.json())}),e},Cjs._Collection.stringify=function(){return JSON.stringify(this.json())},Cjs.Collection=function(e,t){if(!_.isUndefined(t)){var i=this;_.each(t,function(e,t){i[t]=e})}this.reset(),_.isUndefined(e)||this.addAll(e),Cjs._shift.apply(arguments),Cjs._shift.apply(arguments),this.init.apply(this,arguments)},_.extend(Cjs.Collection.prototype,Cjs._Collection,Cjs._Event),Cjs.Collection.extend=Cjs._extend,Cjs._View=function(){},Cjs._View.element=void 0,Cjs._View.template=void 0,Cjs._View.dom={},Cjs._View.model=void 0,Cjs._View.collection=void 0,Cjs._View.init=function(){},Cjs._View.build=function(e){if(_.isUndefined(this.template))return Cjs._log("Cjs.View","Undefined template found."),void 0;if(_.isUndefined(e)){if(!_.isUndefined(this.model))return _.template(this.$template,this.model.json());if(!_.isUndefined(this.collection)){var t="",i=this;return this.collection.each(function(e){t+=_.template(i.$template,e.json())}),t}}return _.template(this.$template,e)},Cjs._View.render=function(){this._render()},Cjs._View._render=function(){if(this.isEnabled()){if(_.isUndefined(this.element))return Cjs._log("Cjs.View","Undefined element found."),void 0;if(this._uncached&&(this.$element=$(this.element),0===this.$element.length))return Cjs._log("Cjs.View","Undefined element found."),void 0;Cjs._log("Cjs.View","Default render used."),this.trigger("renderBefore",this),this.$element.html(this.build()),this.trigger("renderAfter",this)}},Cjs._View.isEnabled=function(){return this._isEnabled},Cjs._View.setEnabled=function(e){return _.isBoolean(e)?(this._isEnabled!==e&&(this._isEnabled=e,this._isEnabled?(this._registerDomEvents(),this.trigger("enabled",this)):(this._unregisterDomEvents(),this.trigger("disabled",this))),void 0):(Cjs._log("Cjs.View","Invalid parameter - enabled, boolean expected."),void 0)},Cjs._View.on=function(e,t,i){return _.isString(e)?_.isString(t)?(_.isString(i)&&(i=this[i],_.isFunction(i)&&(i=_.bind(i,this))),_.isFunction(i)?(""===t&&(t=void 0),this.$element.on(e,t,i),void 0):(Cjs._log("Cjs.View","Invalid parameter - func, function expected."),void 0)):(Cjs._log("Cjs.View","Invalid parameter - selector, string expected."),void 0):(Cjs._log("Cjs.View","Invalid parameter - event, string expected."),void 0)},Cjs._View.off=function(e,t,i){return _.isString(e)?_.isString(t)?(_.isString(i)&&(i=this[i],_.isFunction(i)&&(i=_.bind(i,this))),_.isFunction(i)?(""===t&&(t=void 0),this.$element.off(e,t,i),void 0):(Cjs._log("Cjs.View","Invalid parameter - func, function expected."),void 0)):(Cjs._log("Cjs.View","Invalid parameter - selector, string expected."),void 0):(Cjs._log("Cjs.View","Invalid parameter - event, string expected."),void 0)},Cjs._View._registerDomEvents=function(){if(!this._isRegisteredDomEvents){this._isRegisteredDomEvents=!0;var e=this;_.each(this.dom,function(t,i){var n=i.match(/^(\S+)\s*(.*)$/);_.isNull(n)||e.on(n[1],n[2],t)})}},Cjs._View._unregisterDomEvents=function(){if(this._isRegisteredDomEvents){this._isRegisteredDomEvents=!1;var e=this;_.each(this.dom,function(t,i){var n=i.match(/^(\S+)\s*(.*)$/);_.isNull(n)||e.off(n[1],n[2],t)})}},Cjs.View=function(e){if(!_.isUndefined(e)){var t=this;_.each(e,function(e,i){t[i]=e})}if(this._isEnabled=!1,this._isRegisteredDomEvents=!1,this._uncached=!0,this.element?(this.$element=$(this.element),this._uncached=0===this.$element.length):Cjs._log("Cjs.View","Undefined element found."),this.template){var t=this,i=$.ajax({url:this.template,type:"GET",dataType:"html",async:!1});i.done(function(e){t.$template=e}),i.fail(function(){Cjs._log("Cjs.View",'Cannot retrieve template URL "'+t.template+'".'),t.$template=""})}else Cjs._log("Cjs.View","Undefined template found.");Cjs._shift.apply(arguments),this.init.apply(this,arguments)},_.extend(Cjs.View.prototype,Cjs._View,Cjs._Event),Cjs.View.extend=Cjs._extend,Cjs._CompositeView=function(){},Cjs._CompositeView.views={},Cjs._CompositeView.init=function(){},Cjs._CompositeView.get=function(e){return _.isString(e)?this._views[e]:(Cjs._log("Cjs.CompositeView","Invalid parameter - name, string expected."),void 0)},Cjs._CompositeView.add=function(e,t){return _.isString(e)?_.isUndefined(this._views[e])?(this._views[e]=t,this.trigger("added",this,e,t),this.isEnabled()&&t.setEnabled(!0),void 0):(Cjs._log("Cjs.CompositeView","Cannot add existing view."),void 0):(Cjs._log("Cjs.CompositeView","Invalid parameter - name, string expected."),void 0)},Cjs._CompositeView.remove=function(e){if(!_.isString(e))return Cjs._log("Cjs.CompositeView","Invalid parameter - name, string expected."),void 0;if(_.isUndefined(this._views[e]))return Cjs._log("Cjs.CompositeView","Cannot remove non-existent view."),void 0;var t=this._views[e];return delete this._views[e],this.trigger("removed",this,e,t),this.isEnabled()&&t.setEnabled(!1),t},Cjs._CompositeView.swap=function(e,t){var i=this.remove(e);return _.isUndefined(i)?void 0:(this.add(e,t),this.trigger("swapped",this,e,i,t),i)},Cjs._CompositeView.each=function(e){return _.isFunction(e)?(_.each(this._views,e),void 0):(Cjs._log("Cjs.CompositeView","Invalid parameter - func, function expected."),void 0)},Cjs._CompositeView.reset=function(){this._views={},this.trigger("reset",this);var e=this;_.each(this.views,function(t,i){e.add(i,t)})},Cjs._CompositeView.isEnabled=function(){return this._isEnabled},Cjs._CompositeView.render=function(){this.isEnabled()&&(this.trigger("renderBefore",this),this.each(function(e){e.render()}),this.trigger("renderAfter",this))},Cjs._CompositeView.setEnabled=function(e){if(!_.isBoolean(e))return Cjs._log("Cjs.CompositeView","Invalid parameter - enabled, boolean expected."),void 0;if(this._isEnabled!==e){this._isEnabled=e;var t=this;this.each(function(e){e.setEnabled(t._isEnabled)}),this._isEnabled?this.trigger("enabled",this):this.trigger("disabled",this)}},Cjs._CompositeView._registerDomEvents=function(){this.each(function(e){e._registerDomEvents()})},Cjs._CompositeView._unregisterDomEvents=function(){this.each(function(e){e._unregisterDomEvents()})},Cjs.CompositeView=function(e){if(!_.isUndefined(e)){var t=this;_.each(e,function(e,i){t[i]=e})}this._isEnabled=!1,this.reset(),Cjs._shift.apply(arguments),this.init.apply(this,arguments)},_.extend(Cjs.CompositeView.prototype,Cjs._CompositeView,Cjs._Event),Cjs.CompositeView.extend=Cjs._extend,Cjs._RouterEx=function(){},Cjs._RouterEx.init=function(){},Cjs._RouterEx.register=function(e,t,i){if(!_.isString(e))return Cjs._log("Cjs.Router","Invalid parameter - hash, string expected."),void 0;if(_.isString(t)){if(_.isUndefined(i))return Cjs._log("Cjs.Router","Invalid parameter - obj, object expected."),void 0;t=i[t],_.isFunction(t)&&(t=_.bind(t,i))}if(!_.isFunction(t))return Cjs._log("Cjs.Router","Invalid parameter - func, function expected."),void 0;Cjs._log("Cjs.Router",'Registering route "'+e+'".'),this._routes||(this._routes=[]);var n=e,s=[];if(""!==n){var o=n.split("/");if(!_.isNull(o)){n="";for(var r=0;r<o.length;++r){var a=o[r];"*"===a[0]?(n+="?([\\w-\\.~/]+)/",s.push({tkn:a.substring(1,a.length),index:r+1})):"?"===a[0]&&"$"===a[1]?(n+="?(\\w+)?/",s.push({tkn:a.substring(2,a.length),index:r+1})):"$"===a[0]?(n+="(\\w+)/",s.push({tkn:a.substring(1,a.length),index:r+1})):n+="("+a+")/"}"/"===n[n.length-1]&&(n+="?")}}this._routes.push({hash:e,regex:n,args:s,func:t})},Cjs._RouterEx.start=function(){return this._routes?(_.bindAll(this,"_hashChange"),$(window).on("hashchange",this._hashChange),this._hashChange(),void 0):(Cjs._log("Cjs.Router","No routes registered."),void 0)},Cjs._RouterEx.navigate=function(e){window.location.hash="#"+e},Cjs._RouterEx._hashChange=function(){var e=window.location.href.match("#(.*)$");e=e?e[1]:"";for(var t=!1,i=0;i<this._routes.length;++i){var n=this._routes[i];if(""!==n.hash){var s=e.match(n.regex);if(!_.isNull(s)){for(var o={},r=[n.hash,o],i=0;i<n.args.length;++i){var a=n.args[i];o[a.tkn]=s[a.index],r.push(s[a.index])}this.triggerEx("routeBefore",r),Cjs._call(n.func,r),this.triggerEx("routeAfter",r),t=!0;break}}else if(""===e){this.trigger("routeBefore",n.hash,{}),Cjs._call(n.func,[n.hash,{}]),this.trigger("routeAfter",n.hash,{}),t=!0;break}}t||Cjs._log("Cjs.Router","No routes available.")},Cjs.RouterEx=function(){this.init.apply(this,arguments)},_.extend(Cjs.RouterEx.prototype,Cjs._RouterEx,Cjs._Event),Cjs.RouterEx.extend=Cjs._extend,Cjs.Router=new Cjs.RouterEx,Cjs._Controller=function(){},Cjs._Controller.router=Cjs.Router,Cjs._Controller.routes={},Cjs._Controller.init=function(){},Cjs._Controller._route=function(){this.currentView!=this.nextView&&(this.previousView=this.currentView,this.currentView=this.nextView,this.nextView=void 0,_.isUndefined(this.previousView)||this.previousView.setEnabled(!1),_.isUndefined(this.currentView)||this.currentView.setEnabled(!0))},Cjs.Controller=function(e){if(!_.isUndefined(e)){var t=this;_.each(e,function(e,i){t[i]=e})}this.previousView=void 0,this.currentView=void 0,this.nextView=void 0,this.router.subscribe("routeAfter","_route",this);var t=this;_.each(this.routes,function(e,i){t.router.register(i,e,t)}),Cjs._shift.apply(arguments),this.init.apply(this,arguments)},_.extend(Cjs.Controller.prototype,Cjs._Controller,Cjs._Event),Cjs.Controller.extend=Cjs._extend;